
-- *************** TABLASEJERCICIO4.SQL *****************


-- *************** TABLAS ARTICULOS, TIENDAS,FABRICANTES Y PROFESORES********



DROP TABLE ARTICULOS; 
DROP TABLE TIENDAS; 
DROP TABLE FABRICANTES ; 
DROP TABLE PROFESORES ; 


CREATE TABLE ARTICULOS(
  ARTICULO       VARCHAR(20),
  COD_FABRICANTE NUMBER(3),
  PESO           NUMBER(3),
  CATEGORIA      VARCHAR(10),
  PRECIO_VENTA   NUMBER (6,2),
  PRECIO_COSTO   NUMBER (6,2),
  EXISTENCIAS    NUMBER (5),
  CONSTRAINT ART_CLAV_PK PRIMARY KEY(ARTICULO, COD_FABRICANTE, PESO, CATEGORIA)
 ) ;

INSERT INTO ARTICULOS VALUES ('Macarrones',20, 1, 'Primera',1, 0.98,120);
INSERT INTO ARTICULOS VALUES ('Tallarines',20, 2, 'Primera',1.20,1,100);
INSERT INTO ARTICULOS VALUES ('Tallarines',20, 1, 'Segunda',0.99,0.50,100);
INSERT INTO ARTICULOS VALUES ('Macarrones',20, 1, 'Tercera',0.80,0.50,100);
INSERT INTO ARTICULOS VALUES ('Atún',10, 3, 'Primera',2,1.50,220);
INSERT INTO ARTICULOS VALUES ('Atún',10, 3, 'Segunda',1.50,1,220);
INSERT INTO ARTICULOS VALUES ('Atún',10, 3, 'Tercera',1,0.50,220);
INSERT INTO ARTICULOS VALUES ('Sardinillas',10, 1, 'Primera',2.5,2,200);
INSERT INTO ARTICULOS VALUES ('Sardinillas',10, 1, 'Segunda',2,1.6,200);
INSERT INTO ARTICULOS VALUES ('Sardinillas',10, 1, 'Tercera',1,1.5,220);
INSERT INTO ARTICULOS VALUES ('Mejillones',10, 1, 'Tercera',1,0.9,200);
INSERT INTO ARTICULOS VALUES ('Mejillones',10, 1, 'Primera',3,2,300);
INSERT INTO ARTICULOS VALUES ('Macarrones',25, 1, 'Primera',1.5,1,150);
INSERT INTO ARTICULOS VALUES ('Tallarines',25, 1, 'Primera',1,0.90,100);
INSERT INTO ARTICULOS VALUES ('Fideos',25, 1, 'Segunda',0.75,0.50,100);
INSERT INTO ARTICULOS VALUES ('Fideos',25, 1, 'Primera',1,0.80,100);
INSERT INTO ARTICULOS VALUES ('Galletas Cuadradas',15, 1, 'Primera',2,1.8,100);
INSERT INTO ARTICULOS VALUES ('Galletas Cuadradas',15, 1, 'Segunda',1,0.8,100);
INSERT INTO ARTICULOS VALUES ('Galletas Cuadradas',15, 1, 'Tercera',0.50,0.40,100);
INSERT INTO ARTICULOS VALUES ('Barquillos',15, 1, 'Primera',1,0.80,100);
INSERT INTO ARTICULOS VALUES ('Barquillos',15, 1, 'Segunda',1,0.80,100);
INSERT INTO ARTICULOS VALUES ('Canutillos',15, 2, 'Primera',1.7,1.5,110);
INSERT INTO ARTICULOS VALUES ('Canutillos',15, 2, 'Segunda',1.2,1.5,110);
INSERT INTO ARTICULOS VALUES ('Leche entera',30, 1, 'Primera',1.1,1,300);
INSERT INTO ARTICULOS VALUES ('Leche desnat.',30, 1,'Primera',1.2,1,300);
INSERT INTO ARTICULOS VALUES ('Leche semi.',30, 1, 'Primera',1.30,1.10,300);
INSERT INTO ARTICULOS VALUES ('Leche entera',30, 2,'Primera',2.10,2,300);
INSERT INTO ARTICULOS VALUES ('Leche desnat.',30, 2, 'Primera',2.2,2,300);
INSERT INTO ARTICULOS VALUES ('Leche semi.',30, 2,  'Primera',2.3,2.1,300);
INSERT INTO ARTICULOS VALUES ('Mantequilla',30, 1, 'Primera',1.8,2,200);
INSERT INTO ARTICULOS VALUES ('Mantequilla',30, 1, 'Segunda',1.4,2,200);


CREATE TABLE FABRICANTES(
COD_FABRICANTE NUMBER(3) PRIMARY KEY,
NOMBRE         VARCHAR(15), 
PAIS           VARCHAR(15));

INSERT INTO FABRICANTES VALUES(10,'CALVO', 'ESPAÑA');
INSERT INTO FABRICANTES VALUES(15,'LU', 'BELGICA');
INSERT INTO FABRICANTES VALUES(20,'BARILLA', 'ITALIA');
INSERT INTO FABRICANTES VALUES(25,'GALLO', 'ESPAÑA');
INSERT INTO FABRICANTES VALUES(30,'PRESIDENT', 'FRANCIA');

CREATE TABLE TIENDAS(
NIF       VARCHAR(10) PRIMARY KEY,
NOMBRE    VARCHAR(20),
DIRECCION VARCHAR(20),
POBLACION VARCHAR(20),
PROVINCIA VARCHAR(20),
CODPOSTAL NUMBER(5) );

INSERT INTO TIENDAS VALUES('1111-A','Almacenes Pérez', 'C/Toledo, 20',
 'Siguenza','GUADALAJARA',19104); 
INSERT INTO TIENDAS VALUES('5555-B','La gacela', 'C/Santander Rios, 45',
 'Azuqueca','GUADALAJARA', 19209);
INSERT INTO TIENDAS VALUES('2222-A','Comestibles Rodolfo', 
'C/ del Val s/n', 'Alcalá de Henares','MADRID',28804);
INSERT INTO TIENDAS VALUES('4444-A','La Pasta Gansa', 'C/Alcalá, 2',
 'Ajalvir','MADRID', 28765);
 INSERT INTO TIENDAS VALUES('3333-N','Ultramarinos Montse',
  'Avda. Pio 10', 'Toledo','TOLEDO',45100);
INSERT INTO TIENDAS VALUES('4141-B','Todo Toledo',
 'C/Avila 24', 'Talavera','TOLEDO',45199);





CREATE TABLE PROFESORES (
 COD_CENTRO   NUMBER(4) ,
 DNI          NUMBER(10) PRIMARY KEY,
 APELLIDOS    VARCHAR(30),
 ESPECIALIDAD VARCHAR(16) 
) ;


INSERT INTO PROFESORES VALUES (10,1112345,'Martínez Salas, Fernando','INFORMÁTICA');
INSERT INTO PROFESORES VALUES (10,4123005,'Bueno Zarco, Elisa','MATEMÁTICAS');
INSERT INTO PROFESORES VALUES (10,4122025,'Montes García, M.Pilar','MATEMÁTICAS');
INSERT INTO PROFESORES VALUES (15,9800990, 'Ramos Ruiz, Luis','LENGUA');
INSERT INTO PROFESORES VALUES (15,8660990, 'De Lucas Fdez, M.Angel','LENGUA');
INSERT INTO PROFESORES VALUES (22,7650000, 'Ruiz Lafuente, Manuel','MATEMÁTICAS');
INSERT INTO PROFESORES VALUES (45,43526789, 'Serrano Laguía, María','INFORMÁTICA');
-- *************** FIN *******************************
COMMIT;

--Ej.1 --
CREATE TABLE pedidos
(
nif varchar2(10),
articulos varchar2(10),
cod_fabricante number(3),
peso number(3),
categoria varchar(10),
fecha_pedido date,
unidades_pedidas number(4)
CONSTRAINT ped_pri_pk PRIMARY KEY (NIF, ARTICULO, COD_FABRICANTE, PESO, CATEGORIA, FECHA_PEDIDO),
constraint ped_cod_fk FOREIGN KEY (COD_FABRICANTE) REFERENCES FABRICCANTES,
CONSTRAINT PED_UNI_CK CHECK (UNIDADES_PEDIDAS>0)
CONSTRAINT 
);

CREATE TABLE ventas
(
nif varchar2(10)
articulo varchar2(10)
cod_fabricante number(3)
peso numer(3)
categoria  varchar(10)
fecha_venta date
unidades_vendidas number(4)
CONSTRAINT 



);
--EJ.2--
SELECT * FROM USER_CONSTRAINT WHERE TABLE_NAME='PEDIDOS';
SELECT * FROM USER_CONSTRAINT WHERE TABLE_NAME='VENTAS';

--EJ.3--
ALTER TABLE PEDIDOS MODIFY (UNIDADES_PEDIDAS NUMBER(6));
ALTER TABLE VENTAS MODIFY (UNIDADES_VENDIDAS NUMBER(6));

--EJ.4--
ALTER TABLE PEDIDOS ADD (PVP NUMER(4));
ALTER TABLE VENTAS ADD PVP NUMBER(4));

--EJ.5--
ALTER TABLE PROFESORES ADD(COD_ASIG NUMBER(2));

--EJ.6--
CREATE TABLE TASIG(
COD _ASIG NUMBER(2)
NOM_ASIG VARCHAR(20)
);

--EJ.7--
aLTER TABLE TASIG ADD CONSTRAINT TAS_COD_PK PRIMARY KEY (COD_ASIG);

--EJ.8--
ALTER TABLE PROFESORES ADD CONSTRAINT PRO_ASI_FK FOREIGN KEY  (COD_ASIG) REFERENCES TASIG;

SELECT * FROM USER_CONSTRAINTS WHERE TABLE_NAME='TASIG';
SELECT * FROM USER_CONSTRAINTS WHERE TABLE_NAME='PROFESORES';

--EJ.9--
drop table tasig;

--ej.10--
disable 
